import{d as T,u as V,r as u,y as B,a as o,e as a,k as D,g as r,A as z,F as _,h as p,p as g,b as C,t as v,i as A,z as M,q as S,_ as E}from"./index-CEb9R0bB.js";const N=["onClick"],W={class:"text-sm"},$={class:"flex-1 overflow-hidden relative"},j={key:0,class:"p-8 text-center text-white/60 text-xs animate-pulse"},F={key:1,class:"flex flex-col py-1"},I=["href"],L={class:"flex-1 min-w-0"},q={class:"text-sm text-white/80 group-hover/item:text-white transition-colors line-clamp-2 leading-relaxed"},P={key:0,class:"text-xs text-white/50 mt-0.5"},U=60*1e3,Y=T({__name:"HotWidget",props:{widget:{}},setup(k){const d=V(),w=u([{id:"weibo",label:"å¾®åš",icon:"ðŸ”¥",activeClass:"text-white bg-white/15",barClass:"bg-white/60",indexClass:"text-white bg-white/15"},{id:"news",label:"ä¸­æ–°ç½‘",icon:"ðŸ—žï¸",activeClass:"text-white bg-white/15",barClass:"bg-white/60",indexClass:"text-white bg-white/15"},{id:"zhihu",label:"çŸ¥ä¹Ž",icon:"ðŸ§ ",activeClass:"text-white bg-white/15",barClass:"bg-white/60",indexClass:"text-white bg-white/15"},{id:"bilibili",label:"Bç«™",icon:"ðŸ“º",activeClass:"text-white bg-white/15",barClass:"bg-white/60",indexClass:"text-white bg-white/15"}]),f=u({}),x=u("weibo"),l=u([]),b=u(!1),m=async(t,i=!1)=>{x.value=t;const e=Date.now();if(!i&&f.value[t]&&e-f.value[t].ts<U){l.value=f.value[t].data;return}b.value=!0,l.value=[];const s=n=>{n.type===t&&(l.value=n.data,f.value[t]={data:l.value,ts:Date.now()},b.value=!1,h())},c=n=>{n.type===t&&(console.error(`åŠ è½½ ${t} å¤±è´¥`,n.error),l.value=[{title:"åŠ è½½å¤±è´¥ï¼Œè¯·é‡è¯•",url:"#",hot:""}],b.value=!1,h())},h=()=>{d.socket.off("hot:data",s),d.socket.off("hot:error",c)};d.socket.on("hot:data",s),d.socket.on("hot:error",c),d.socket.emit("hot:fetch",{type:t,force:i})};B(()=>{m("weibo")});const y=t=>{const i=t.currentTarget,{scrollTop:e,scrollHeight:s,clientHeight:c}=i,h=t.deltaY,n=e<=0,H=e+c>=s-1;(n&&h<0||H&&h>0)&&(t.preventDefault(),t.stopPropagation())};return(t,i)=>(a(),o("div",{class:"w-full h-full rounded-2xl backdrop-blur border border-white/10 overflow-hidden flex flex-col text-white relative transition-shadow",style:S({backgroundColor:`rgba(0,0,0,${Math.min(.85,Math.max(.15,k.widget.opacity??.35))})`,color:"#fff"})},[D(A(M),{modelValue:w.value,"onUpdate:modelValue":i[0]||(i[0]=e=>w.value=e),class:"flex border-b border-white/10 bg-white/10 select-none",animation:150},{default:z(()=>[(a(!0),o(_,null,p(w.value,e=>(a(),o("button",{key:e.id,onClick:s=>m(e.id),class:g(["flex-1 py-2.5 text-xs font-bold transition-all flex items-center justify-center gap-1.5 relative overflow-hidden cursor-move",x.value===e.id?e.activeClass:"text-white/60 hover:bg-white/10 hover:text-white"])},[r("span",W,v(e.icon),1),r("span",null,v(e.label),1),x.value===e.id?(a(),o("div",{key:0,class:g(["absolute bottom-0 left-0 right-0 h-0.5",e.barClass])},null,2)):C("",!0)],10,N))),128))]),_:1},8,["modelValue"]),r("div",$,[r("div",{class:"h-full overflow-y-auto custom-scrollbar p-0",onWheel:y},[b.value&&l.value.length===0?(a(),o("div",j," åŠ è½½ä¸­... ")):(a(),o("div",F,[(a(!0),o(_,null,p(l.value,(e,s)=>(a(),o("a",{key:s,href:e.url,target:"_blank",class:"block px-3 py-1 hover:bg-white/10 transition-colors group/item flex items-start gap-2"},[r("span",{class:g(["text-xs font-bold min-w-[1.25rem] h-5 flex items-center justify-center rounded mt-0.5 transition-colors",s<3?w.value.find(c=>c.id===x.value)?.indexClass:"text-white/60 bg-white/10"])},v(s+1),3),r("div",L,[r("div",q,v(e.title),1),e.hot?(a(),o("div",P,v(e.hot),1)):C("",!0)])],8,I))),128))]))],32)])],4))}}),J=E(Y,[["__scopeId","data-v-60ea0aed"]]);export{J as default};
