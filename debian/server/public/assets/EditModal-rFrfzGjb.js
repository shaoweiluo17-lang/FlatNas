import{d as Te,u as We,r as O,w as Ce,o as ct,c as de,a as k,b as _,e as A,f as ae,g as a,t as D,F as ne,h as he,i as Ee,j as Z,s as ue,k as we,l as $,v as Re,m as L,n as se,p as G,q as dt,_ as ht}from"./index-CEb9R0bB.js";import{_ as je}from"./IconUploader.vue_vue_type_script_setup_true_lang-BxQwLW54.js";const gt={class:"bg-white rounded-xl shadow-2xl p-6 w-full max-w-2xl max-h-[80vh] flex flex-col animate-in fade-in zoom-in duration-200"},ft={class:"flex justify-between items-center mb-4"},pt={class:"text-lg font-bold text-gray-900 flex items-center gap-2"},mt={key:0},vt={key:1},yt={class:"text-sm font-normal text-gray-500"},xt={class:"text-sm text-orange-500 font-medium bg-orange-50 px-2 py-1 rounded-full flex items-center gap-1"},bt={class:"flex-1 overflow-y-auto p-2 min-h-[200px]"},wt={key:0,class:"mb-6"},kt={class:"grid grid-cols-4 sm:grid-cols-6 gap-4"},At=["onClick"],Ct={class:"w-12 h-12 flex items-center justify-center bg-white rounded-lg shadow-sm group-hover:scale-110 transition-transform"},Et=["src"],It=["title"],Mt={class:"grid grid-cols-4 sm:grid-cols-6 gap-4"},Bt=["onClick"],$t={class:"w-12 h-12 flex items-center justify-center bg-white rounded-lg shadow-sm group-hover:scale-110 transition-transform"},_t=["src"],Ft=["title"],Lt={key:1,class:"mt-4 flex justify-center"},St={class:"mt-6 flex justify-between items-center border-t pt-4"},Ut={key:1},ke=100,Dt=Te({__name:"IconSelectionModal",props:{show:{type:Boolean},candidates:{},title:{},source:{}},emits:["update:show","select","cancelLink"],setup(n,{emit:e}){const s=n,l=e,i=We(),c=O(10);let d=null;const f=()=>{clearInterval(d),c.value=10,d=setInterval(()=>{if(c.value--,c.value<=0&&s.candidates.length>0){const w=s.candidates[0];w&&h(w)}},1e3)},h=w=>{clearInterval(d),l("select",w),l("update:show",!1)};Ce(()=>s.show,w=>{w?f():clearInterval(d)}),ct(()=>clearInterval(d));const g=w=>{try{if(!w)return"";const r=w.split("/"),I=r[r.length-1];if(!I)return w;const F=I?.split(".")[0]||"";return decodeURIComponent(F)}catch{return w}},p=O(ke),x=de(()=>s.candidates.slice(0,p.value)),b=de(()=>p.value<s.candidates.length),C=()=>{p.value+=ke};Ce(()=>[s.candidates,s.show],()=>{p.value=ke});const E=["icons/douyin.svg"];return(w,r)=>n.show?(A(),k("div",{key:0,class:"fixed inset-0 z-[60] flex items-center justify-center bg-black/50 backdrop-blur-sm",onClick:r[2]||(r[2]=ae(I=>w.$emit("update:show",!1),["self"]))},[a("div",gt,[a("div",ft,[a("h3",pt,[n.source==="local"?(A(),k("span",mt,"ðŸ“ æœ¬åœ°å›¾æ ‡")):(A(),k("span",vt,"ðŸŒ ç½‘ç»œå›¾æ ‡")),a("span",yt,"("+D(n.candidates.length)+"ä¸ªåŒ¹é…)",1)]),a("div",xt,[r[3]||(r[3]=a("span",null,"â±ï¸",-1)),a("span",null,D(c.value)+"s åŽè‡ªåŠ¨é€‰æ‹©",1)])]),a("div",bt,[E.length>0&&n.source==="local"?(A(),k("div",wt,[r[4]||(r[4]=a("h4",{class:"text-xs font-bold text-gray-400 mb-3 uppercase tracking-wider"},"æŽ¨èå›¾æ ‡",-1)),a("div",kt,[(A(),k(ne,null,he(E,I=>a("button",{key:I,onClick:F=>h(I),class:"group flex flex-col items-center gap-3 p-3 rounded-xl hover:bg-blue-50 transition-all border border-gray-100 hover:border-blue-200 hover:shadow-md"},[a("div",Ct,[a("img",{src:Ee(i).getAssetUrl(I),class:"w-8 h-8 object-contain",loading:"lazy"},null,8,Et)]),a("span",{class:"text-xs text-gray-600 truncate w-full text-center font-medium",title:g(I)},D(g(I)),9,It)],8,At)),64))])])):_("",!0),a("div",Mt,[(A(!0),k(ne,null,he(x.value,I=>(A(),k("button",{key:I,onClick:F=>h(I),class:"group flex flex-col items-center gap-3 p-3 rounded-xl hover:bg-blue-50 transition-all border border-gray-100 hover:border-blue-200 hover:shadow-md"},[a("div",$t,[a("img",{src:Ee(i).getAssetUrl(I),class:"w-8 h-8 object-contain",loading:"lazy"},null,8,_t)]),a("span",{class:"text-xs text-gray-600 truncate w-full text-center font-medium",title:g(I)},D(g(I)),9,Ft)],8,Bt))),128))]),b.value?(A(),k("div",Lt,[a("button",{onClick:C,class:"px-4 py-2 text-sm text-blue-600 bg-blue-50 hover:bg-blue-100 rounded-full transition-colors"}," åŠ è½½æ›´å¤š ("+D(n.candidates.length-p.value)+" ä¸ª) ",1)])):_("",!0)]),a("div",St,[n.source==="api"?(A(),k("button",{key:0,onClick:r[0]||(r[0]=I=>w.$emit("cancelLink")),class:"px-4 py-2 rounded-lg text-red-500 hover:bg-red-50 font-medium transition-colors flex items-center gap-1"},[...r[5]||(r[5]=[a("span",null,"ðŸ”—",-1),Z(" å–æ¶ˆé“¾æŽ¥ ",-1)])])):(A(),k("div",Ut)),a("button",{onClick:r[1]||(r[1]=I=>w.$emit("update:show",!1)),class:"px-6 py-2 rounded-lg bg-gray-100 text-gray-700 hover:bg-gray-200 font-medium transition-colors"}," å–æ¶ˆ ")])])])):_("",!0)}});function W(n){return Array.isArray?Array.isArray(n):Ge(n)==="[object Array]"}function Rt(n){if(typeof n=="string")return n;let e=n+"";return e=="0"&&1/n==-1/0?"-0":e}function jt(n){return n==null?"":Rt(n)}function N(n){return typeof n=="string"}function Ke(n){return typeof n=="number"}function Pt(n){return n===!0||n===!1||Ot(n)&&Ge(n)=="[object Boolean]"}function Ye(n){return typeof n=="object"}function Ot(n){return Ye(n)&&n!==null}function R(n){return n!=null}function Ae(n){return!n.trim().length}function Ge(n){return n==null?n===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(n)}const Nt="Incorrect 'index' type",Vt=n=>`Invalid value for key ${n}`,zt=n=>`Pattern length exceeds max of ${n}.`,Tt=n=>`Missing ${n} property in key`,Wt=n=>`Property 'weight' in key '${n}' must be a positive integer`,Pe=Object.prototype.hasOwnProperty;class Kt{constructor(e){this._keys=[],this._keyMap={};let s=0;e.forEach(l=>{let i=He(l);this._keys.push(i),this._keyMap[i.id]=i,s+=i.weight}),this._keys.forEach(l=>{l.weight/=s})}get(e){return this._keyMap[e]}keys(){return this._keys}toJSON(){return JSON.stringify(this._keys)}}function He(n){let e=null,s=null,l=null,i=1,c=null;if(N(n)||W(n))l=n,e=Oe(n),s=Ie(n);else{if(!Pe.call(n,"name"))throw new Error(Tt("name"));const d=n.name;if(l=d,Pe.call(n,"weight")&&(i=n.weight,i<=0))throw new Error(Wt(d));e=Oe(d),s=Ie(d),c=n.getFn}return{path:e,id:s,weight:i,src:l,getFn:c}}function Oe(n){return W(n)?n:n.split(".")}function Ie(n){return W(n)?n.join("."):n}function Yt(n,e){let s=[],l=!1;const i=(c,d,f)=>{if(R(c))if(!d[f])s.push(c);else{let h=d[f];const g=c[h];if(!R(g))return;if(f===d.length-1&&(N(g)||Ke(g)||Pt(g)))s.push(jt(g));else if(W(g)){l=!0;for(let p=0,x=g.length;p<x;p+=1)i(g[p],d,f+1)}else d.length&&i(g,d,f+1)}};return i(n,N(e)?e.split("."):e,0),l?s:s[0]}const Gt={includeMatches:!1,findAllMatches:!1,minMatchCharLength:1},Ht={isCaseSensitive:!1,ignoreDiacritics:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:(n,e)=>n.score===e.score?n.idx<e.idx?-1:1:n.score<e.score?-1:1},Jt={location:0,threshold:.6,distance:100},Qt={useExtendedSearch:!1,getFn:Yt,ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1};var y={...Ht,...Gt,...Jt,...Qt};const Xt=/[^ ]+/g;function Zt(n=1,e=3){const s=new Map,l=Math.pow(10,e);return{get(i){const c=i.match(Xt).length;if(s.has(c))return s.get(c);const d=1/Math.pow(c,.5*n),f=parseFloat(Math.round(d*l)/l);return s.set(c,f),f},clear(){s.clear()}}}class Le{constructor({getFn:e=y.getFn,fieldNormWeight:s=y.fieldNormWeight}={}){this.norm=Zt(s,3),this.getFn=e,this.isCreated=!1,this.setIndexRecords()}setSources(e=[]){this.docs=e}setIndexRecords(e=[]){this.records=e}setKeys(e=[]){this.keys=e,this._keysMap={},e.forEach((s,l)=>{this._keysMap[s.id]=l})}create(){this.isCreated||!this.docs.length||(this.isCreated=!0,N(this.docs[0])?this.docs.forEach((e,s)=>{this._addString(e,s)}):this.docs.forEach((e,s)=>{this._addObject(e,s)}),this.norm.clear())}add(e){const s=this.size();N(e)?this._addString(e,s):this._addObject(e,s)}removeAt(e){this.records.splice(e,1);for(let s=e,l=this.size();s<l;s+=1)this.records[s].i-=1}getValueForItemAtKeyId(e,s){return e[this._keysMap[s]]}size(){return this.records.length}_addString(e,s){if(!R(e)||Ae(e))return;let l={v:e,i:s,n:this.norm.get(e)};this.records.push(l)}_addObject(e,s){let l={i:s,$:{}};this.keys.forEach((i,c)=>{let d=i.getFn?i.getFn(e):this.getFn(e,i.path);if(R(d)){if(W(d)){let f=[];const h=[{nestedArrIndex:-1,value:d}];for(;h.length;){const{nestedArrIndex:g,value:p}=h.pop();if(R(p))if(N(p)&&!Ae(p)){let x={v:p,i:g,n:this.norm.get(p)};f.push(x)}else W(p)&&p.forEach((x,b)=>{h.push({nestedArrIndex:b,value:x})})}l.$[c]=f}else if(N(d)&&!Ae(d)){let f={v:d,n:this.norm.get(d)};l.$[c]=f}}}),this.records.push(l)}toJSON(){return{keys:this.keys,records:this.records}}}function Je(n,e,{getFn:s=y.getFn,fieldNormWeight:l=y.fieldNormWeight}={}){const i=new Le({getFn:s,fieldNormWeight:l});return i.setKeys(n.map(He)),i.setSources(e),i.create(),i}function qt(n,{getFn:e=y.getFn,fieldNormWeight:s=y.fieldNormWeight}={}){const{keys:l,records:i}=n,c=new Le({getFn:e,fieldNormWeight:s});return c.setKeys(l),c.setIndexRecords(i),c}function ce(n,{errors:e=0,currentLocation:s=0,expectedLocation:l=0,distance:i=y.distance,ignoreLocation:c=y.ignoreLocation}={}){const d=e/n.length;if(c)return d;const f=Math.abs(l-s);return i?d+f/i:f?1:d}function es(n=[],e=y.minMatchCharLength){let s=[],l=-1,i=-1,c=0;for(let d=n.length;c<d;c+=1){let f=n[c];f&&l===-1?l=c:!f&&l!==-1&&(i=c-1,i-l+1>=e&&s.push([l,i]),l=-1)}return n[c-1]&&c-l>=e&&s.push([l,c-1]),s}const q=32;function ts(n,e,s,{location:l=y.location,distance:i=y.distance,threshold:c=y.threshold,findAllMatches:d=y.findAllMatches,minMatchCharLength:f=y.minMatchCharLength,includeMatches:h=y.includeMatches,ignoreLocation:g=y.ignoreLocation}={}){if(e.length>q)throw new Error(zt(q));const p=e.length,x=n.length,b=Math.max(0,Math.min(l,x));let C=c,E=b;const w=f>1||h,r=w?Array(x):[];let I;for(;(I=n.indexOf(e,E))>-1;){let S=ce(e,{currentLocation:I,expectedLocation:b,distance:i,ignoreLocation:g});if(C=Math.min(S,C),E=I+p,w){let j=0;for(;j<p;)r[I+j]=1,j+=1}}E=-1;let F=[],V=1,z=p+x;const pe=1<<p-1;for(let S=0;S<p;S+=1){let j=0,P=z;for(;j<P;)ce(e,{errors:S,currentLocation:b+P,expectedLocation:b,distance:i,ignoreLocation:g})<=C?j=P:z=P,P=Math.floor((z-j)/2+j);z=P;let ee=Math.max(1,b-P+1),re=d?x:Math.min(b+P,x)+p,K=Array(re+2);K[re+1]=(1<<S)-1;for(let U=re;U>=ee;U-=1){let te=U-1,le=s[n.charAt(te)];if(w&&(r[te]=+!!le),K[U]=(K[U+1]<<1|1)&le,S&&(K[U]|=(F[U+1]|F[U])<<1|1|F[U+1]),K[U]&pe&&(V=ce(e,{errors:S,currentLocation:te,expectedLocation:b,distance:i,ignoreLocation:g}),V<=C)){if(C=V,E=te,E<=b)break;ee=Math.max(1,2*b-E)}}if(ce(e,{errors:S+1,currentLocation:b,expectedLocation:b,distance:i,ignoreLocation:g})>C)break;F=K}const J={isMatch:E>=0,score:Math.max(.001,V)};if(w){const S=es(r,f);S.length?h&&(J.indices=S):J.isMatch=!1}return J}function ss(n){let e={};for(let s=0,l=n.length;s<l;s+=1){const i=n.charAt(s);e[i]=(e[i]||0)|1<<l-s-1}return e}const ge=String.prototype.normalize?(n=>n.normalize("NFD").replace(/[\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u07FD\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08D3-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u09FE\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0AFA-\u0AFF\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B62\u0B63\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C00-\u0C04\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0D00-\u0D03\u0D3B\u0D3C\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D82\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EB9\u0EBB\u0EBC\u0EC8-\u0ECD\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109D\u135D-\u135F\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u180B-\u180D\u1885\u1886\u18A9\u1920-\u192B\u1930-\u193B\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F\u1AB0-\u1ABE\u1B00-\u1B04\u1B34-\u1B44\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BF3\u1C24-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF2-\u1CF4\u1CF7-\u1CF9\u1DC0-\u1DF9\u1DFB-\u1DFF\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA880\uA881\uA8B4-\uA8C5\uA8E0-\uA8F1\uA8FF\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9E5\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F]/g,"")):(n=>n);class Qe{constructor(e,{location:s=y.location,threshold:l=y.threshold,distance:i=y.distance,includeMatches:c=y.includeMatches,findAllMatches:d=y.findAllMatches,minMatchCharLength:f=y.minMatchCharLength,isCaseSensitive:h=y.isCaseSensitive,ignoreDiacritics:g=y.ignoreDiacritics,ignoreLocation:p=y.ignoreLocation}={}){if(this.options={location:s,threshold:l,distance:i,includeMatches:c,findAllMatches:d,minMatchCharLength:f,isCaseSensitive:h,ignoreDiacritics:g,ignoreLocation:p},e=h?e:e.toLowerCase(),e=g?ge(e):e,this.pattern=e,this.chunks=[],!this.pattern.length)return;const x=(C,E)=>{this.chunks.push({pattern:C,alphabet:ss(C),startIndex:E})},b=this.pattern.length;if(b>q){let C=0;const E=b%q,w=b-E;for(;C<w;)x(this.pattern.substr(C,q),C),C+=q;if(E){const r=b-q;x(this.pattern.substr(r),r)}}else x(this.pattern,0)}searchIn(e){const{isCaseSensitive:s,ignoreDiacritics:l,includeMatches:i}=this.options;if(e=s?e:e.toLowerCase(),e=l?ge(e):e,this.pattern===e){let w={isMatch:!0,score:0};return i&&(w.indices=[[0,e.length-1]]),w}const{location:c,distance:d,threshold:f,findAllMatches:h,minMatchCharLength:g,ignoreLocation:p}=this.options;let x=[],b=0,C=!1;this.chunks.forEach(({pattern:w,alphabet:r,startIndex:I})=>{const{isMatch:F,score:V,indices:z}=ts(e,w,r,{location:c+I,distance:d,threshold:f,findAllMatches:h,minMatchCharLength:g,includeMatches:i,ignoreLocation:p});F&&(C=!0),b+=V,F&&z&&(x=[...x,...z])});let E={isMatch:C,score:C?b/this.chunks.length:1};return C&&i&&(E.indices=x),E}}class H{constructor(e){this.pattern=e}static isMultiMatch(e){return Ne(e,this.multiRegex)}static isSingleMatch(e){return Ne(e,this.singleRegex)}search(){}}function Ne(n,e){const s=n.match(e);return s?s[1]:null}class ns extends H{constructor(e){super(e)}static get type(){return"exact"}static get multiRegex(){return/^="(.*)"$/}static get singleRegex(){return/^=(.*)$/}search(e){const s=e===this.pattern;return{isMatch:s,score:s?0:1,indices:[0,this.pattern.length-1]}}}class rs extends H{constructor(e){super(e)}static get type(){return"inverse-exact"}static get multiRegex(){return/^!"(.*)"$/}static get singleRegex(){return/^!(.*)$/}search(e){const l=e.indexOf(this.pattern)===-1;return{isMatch:l,score:l?0:1,indices:[0,e.length-1]}}}class os extends H{constructor(e){super(e)}static get type(){return"prefix-exact"}static get multiRegex(){return/^\^"(.*)"$/}static get singleRegex(){return/^\^(.*)$/}search(e){const s=e.startsWith(this.pattern);return{isMatch:s,score:s?0:1,indices:[0,this.pattern.length-1]}}}class as extends H{constructor(e){super(e)}static get type(){return"inverse-prefix-exact"}static get multiRegex(){return/^!\^"(.*)"$/}static get singleRegex(){return/^!\^(.*)$/}search(e){const s=!e.startsWith(this.pattern);return{isMatch:s,score:s?0:1,indices:[0,e.length-1]}}}class ls extends H{constructor(e){super(e)}static get type(){return"suffix-exact"}static get multiRegex(){return/^"(.*)"\$$/}static get singleRegex(){return/^(.*)\$$/}search(e){const s=e.endsWith(this.pattern);return{isMatch:s,score:s?0:1,indices:[e.length-this.pattern.length,e.length-1]}}}class is extends H{constructor(e){super(e)}static get type(){return"inverse-suffix-exact"}static get multiRegex(){return/^!"(.*)"\$$/}static get singleRegex(){return/^!(.*)\$$/}search(e){const s=!e.endsWith(this.pattern);return{isMatch:s,score:s?0:1,indices:[0,e.length-1]}}}class Xe extends H{constructor(e,{location:s=y.location,threshold:l=y.threshold,distance:i=y.distance,includeMatches:c=y.includeMatches,findAllMatches:d=y.findAllMatches,minMatchCharLength:f=y.minMatchCharLength,isCaseSensitive:h=y.isCaseSensitive,ignoreDiacritics:g=y.ignoreDiacritics,ignoreLocation:p=y.ignoreLocation}={}){super(e),this._bitapSearch=new Qe(e,{location:s,threshold:l,distance:i,includeMatches:c,findAllMatches:d,minMatchCharLength:f,isCaseSensitive:h,ignoreDiacritics:g,ignoreLocation:p})}static get type(){return"fuzzy"}static get multiRegex(){return/^"(.*)"$/}static get singleRegex(){return/^(.*)$/}search(e){return this._bitapSearch.searchIn(e)}}class Ze extends H{constructor(e){super(e)}static get type(){return"include"}static get multiRegex(){return/^'"(.*)"$/}static get singleRegex(){return/^'(.*)$/}search(e){let s=0,l;const i=[],c=this.pattern.length;for(;(l=e.indexOf(this.pattern,s))>-1;)s=l+c,i.push([l,s-1]);const d=!!i.length;return{isMatch:d,score:d?0:1,indices:i}}}const Me=[ns,Ze,os,as,is,ls,rs,Xe],Ve=Me.length,us=/ +(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/,cs="|";function ds(n,e={}){return n.split(cs).map(s=>{let l=s.trim().split(us).filter(c=>c&&!!c.trim()),i=[];for(let c=0,d=l.length;c<d;c+=1){const f=l[c];let h=!1,g=-1;for(;!h&&++g<Ve;){const p=Me[g];let x=p.isMultiMatch(f);x&&(i.push(new p(x,e)),h=!0)}if(!h)for(g=-1;++g<Ve;){const p=Me[g];let x=p.isSingleMatch(f);if(x){i.push(new p(x,e));break}}}return i})}const hs=new Set([Xe.type,Ze.type]);class gs{constructor(e,{isCaseSensitive:s=y.isCaseSensitive,ignoreDiacritics:l=y.ignoreDiacritics,includeMatches:i=y.includeMatches,minMatchCharLength:c=y.minMatchCharLength,ignoreLocation:d=y.ignoreLocation,findAllMatches:f=y.findAllMatches,location:h=y.location,threshold:g=y.threshold,distance:p=y.distance}={}){this.query=null,this.options={isCaseSensitive:s,ignoreDiacritics:l,includeMatches:i,minMatchCharLength:c,findAllMatches:f,ignoreLocation:d,location:h,threshold:g,distance:p},e=s?e:e.toLowerCase(),e=l?ge(e):e,this.pattern=e,this.query=ds(this.pattern,this.options)}static condition(e,s){return s.useExtendedSearch}searchIn(e){const s=this.query;if(!s)return{isMatch:!1,score:1};const{includeMatches:l,isCaseSensitive:i,ignoreDiacritics:c}=this.options;e=i?e:e.toLowerCase(),e=c?ge(e):e;let d=0,f=[],h=0;for(let g=0,p=s.length;g<p;g+=1){const x=s[g];f.length=0,d=0;for(let b=0,C=x.length;b<C;b+=1){const E=x[b],{isMatch:w,indices:r,score:I}=E.search(e);if(w){if(d+=1,h+=I,l){const F=E.constructor.type;hs.has(F)?f=[...f,...r]:f.push(r)}}else{h=0,d=0,f.length=0;break}}if(d){let b={isMatch:!0,score:h/d};return l&&(b.indices=f),b}}return{isMatch:!1,score:1}}}const Be=[];function fs(...n){Be.push(...n)}function $e(n,e){for(let s=0,l=Be.length;s<l;s+=1){let i=Be[s];if(i.condition(n,e))return new i(n,e)}return new Qe(n,e)}const fe={AND:"$and",OR:"$or"},_e={PATH:"$path",PATTERN:"$val"},Fe=n=>!!(n[fe.AND]||n[fe.OR]),ps=n=>!!n[_e.PATH],ms=n=>!W(n)&&Ye(n)&&!Fe(n),ze=n=>({[fe.AND]:Object.keys(n).map(e=>({[e]:n[e]}))});function qe(n,e,{auto:s=!0}={}){const l=i=>{let c=Object.keys(i);const d=ps(i);if(!d&&c.length>1&&!Fe(i))return l(ze(i));if(ms(i)){const h=d?i[_e.PATH]:c[0],g=d?i[_e.PATTERN]:i[h];if(!N(g))throw new Error(Vt(h));const p={keyId:Ie(h),pattern:g};return s&&(p.searcher=$e(g,e)),p}let f={children:[],operator:c[0]};return c.forEach(h=>{const g=i[h];W(g)&&g.forEach(p=>{f.children.push(l(p))})}),f};return Fe(n)||(n=ze(n)),l(n)}function vs(n,{ignoreFieldNorm:e=y.ignoreFieldNorm}){n.forEach(s=>{let l=1;s.matches.forEach(({key:i,norm:c,score:d})=>{const f=i?i.weight:null;l*=Math.pow(d===0&&f?Number.EPSILON:d,(f||1)*(e?1:c))}),s.score=l})}function ys(n,e){const s=n.matches;e.matches=[],R(s)&&s.forEach(l=>{if(!R(l.indices)||!l.indices.length)return;const{indices:i,value:c}=l;let d={indices:i,value:c};l.key&&(d.key=l.key.src),l.idx>-1&&(d.refIndex=l.idx),e.matches.push(d)})}function xs(n,e){e.score=n.score}function bs(n,e,{includeMatches:s=y.includeMatches,includeScore:l=y.includeScore}={}){const i=[];return s&&i.push(ys),l&&i.push(xs),n.map(c=>{const{idx:d}=c,f={item:e[d],refIndex:d};return i.length&&i.forEach(h=>{h(c,f)}),f})}class T{constructor(e,s={},l){this.options={...y,...s},this.options.useExtendedSearch,this._keyStore=new Kt(this.options.keys),this.setCollection(e,l)}setCollection(e,s){if(this._docs=e,s&&!(s instanceof Le))throw new Error(Nt);this._myIndex=s||Je(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}add(e){R(e)&&(this._docs.push(e),this._myIndex.add(e))}remove(e=()=>!1){const s=[];for(let l=0,i=this._docs.length;l<i;l+=1){const c=this._docs[l];e(c,l)&&(this.removeAt(l),l-=1,i-=1,s.push(c))}return s}removeAt(e){this._docs.splice(e,1),this._myIndex.removeAt(e)}getIndex(){return this._myIndex}search(e,{limit:s=-1}={}){const{includeMatches:l,includeScore:i,shouldSort:c,sortFn:d,ignoreFieldNorm:f}=this.options;let h=N(e)?N(this._docs[0])?this._searchStringList(e):this._searchObjectList(e):this._searchLogical(e);return vs(h,{ignoreFieldNorm:f}),c&&h.sort(d),Ke(s)&&s>-1&&(h=h.slice(0,s)),bs(h,this._docs,{includeMatches:l,includeScore:i})}_searchStringList(e){const s=$e(e,this.options),{records:l}=this._myIndex,i=[];return l.forEach(({v:c,i:d,n:f})=>{if(!R(c))return;const{isMatch:h,score:g,indices:p}=s.searchIn(c);h&&i.push({item:c,idx:d,matches:[{score:g,value:c,norm:f,indices:p}]})}),i}_searchLogical(e){const s=qe(e,this.options),l=(f,h,g)=>{if(!f.children){const{keyId:x,searcher:b}=f,C=this._findMatches({key:this._keyStore.get(x),value:this._myIndex.getValueForItemAtKeyId(h,x),searcher:b});return C&&C.length?[{idx:g,item:h,matches:C}]:[]}const p=[];for(let x=0,b=f.children.length;x<b;x+=1){const C=f.children[x],E=l(C,h,g);if(E.length)p.push(...E);else if(f.operator===fe.AND)return[]}return p},i=this._myIndex.records,c={},d=[];return i.forEach(({$:f,i:h})=>{if(R(f)){let g=l(s,f,h);g.length&&(c[h]||(c[h]={idx:h,item:f,matches:[]},d.push(c[h])),g.forEach(({matches:p})=>{c[h].matches.push(...p)}))}}),d}_searchObjectList(e){const s=$e(e,this.options),{keys:l,records:i}=this._myIndex,c=[];return i.forEach(({$:d,i:f})=>{if(!R(d))return;let h=[];l.forEach((g,p)=>{h.push(...this._findMatches({key:g,value:d[p],searcher:s}))}),h.length&&c.push({idx:f,item:d,matches:h})}),c}_findMatches({key:e,value:s,searcher:l}){if(!R(s))return[];let i=[];if(W(s))s.forEach(({v:c,i:d,n:f})=>{if(!R(c))return;const{isMatch:h,score:g,indices:p}=l.searchIn(c);h&&i.push({score:g,key:e,value:c,idx:d,norm:f,indices:p})});else{const{v:c,n:d}=s,{isMatch:f,score:h,indices:g}=l.searchIn(c);f&&i.push({score:h,key:e,value:c,norm:d,indices:g})}return i}}T.version="7.1.0";T.createIndex=Je;T.parseIndex=qt;T.config=y;T.parseQuery=qe;fs(gs);const ws={key:0,class:"fixed inset-0 bg-black/40 backdrop-blur-sm z-50 flex items-center justify-center p-4"},ks={class:"bg-white rounded-2xl shadow-2xl w-full max-w-md overflow-hidden transform transition-all scale-100"},As={class:"px-6 py-4 border-b border-gray-100 flex justify-between items-center bg-white"},Cs={class:"text-lg font-bold text-gray-800"},Es={class:"flex items-center gap-2 ml-auto mr-4"},Is={class:"relative inline-flex items-center cursor-pointer"},Ms={class:"p-6 space-y-5 max-h-[70vh] overflow-y-auto"},Bs={class:"flex gap-3"},$s={class:"flex-1"},_s={class:"relative"},Fs={class:"flex items-center h-[42px] px-2 border border-gray-200 rounded-lg bg-white"},Ls={key:0},Ss={class:"relative"},Us={key:0,class:"space-y-2 mt-2"},Ds={class:"relative flex-1 w-full sm:w-auto"},Rs=["onUpdate:modelValue"],js=["onClick"],Ps={class:"relative flex-[2] w-full sm:w-auto"},Os=["onUpdate:modelValue"],Ns=["onClick"],Vs=["onClick"],zs={key:0,class:"space-y-2 mt-2"},Ts={class:"relative flex-1 w-full sm:w-auto"},Ws=["onUpdate:modelValue"],Ks=["onClick"],Ys={class:"relative flex-[2] w-full sm:w-auto"},Gs=["onUpdate:modelValue"],Hs=["onClick"],Js=["onClick"],Qs={class:"flex items-start justify-between gap-4 mb-3"},Xs={class:"flex-1"},Zs={class:"flex items-center gap-4 mb-2"},qs={class:"flex bg-gray-100 p-0.5 rounded-lg text-xs"},en={key:0,class:"flex items-center gap-2 text-xs text-gray-600 mb-2 select-none"},tn={class:"flex justify-start items-center gap-2"},sn=["disabled"],nn={key:0,class:"w-3 h-3 border-2 border-current border-t-transparent rounded-full animate-spin"},rn=["disabled"],on={key:0,class:"w-3 h-3 border-2 border-current border-t-transparent rounded-full animate-spin"},an={class:"shrink-0 w-16 h-16 rounded-xl border bg-gray-50 flex items-center justify-center overflow-hidden shadow-sm"},ln=["src"],un={key:1,class:"text-gray-300 text-xs"},cn={key:0,class:"text-3xl"},dn={key:1,class:"text-gray-300 text-xs"},hn={key:0,class:"relative animate-fade-in"},gn={key:1,class:"space-y-3 animate-fade-in"},fn={class:"relative"},pn={class:"flex items-center gap-2 bg-gray-50 px-2 py-1.5 rounded-lg border border-gray-100"},mn={class:"text-xs text-gray-500 w-8 text-right"},vn={class:"pt-4 border-t border-gray-100"},yn={class:"space-y-3"},xn={class:"flex items-center gap-2"},bn={key:0,class:"grid grid-cols-2 gap-4 mt-2 p-3 bg-gray-50 rounded-lg"},wn={class:"block text-xs text-gray-500 mb-1 flex justify-between"},kn={class:"block text-xs text-gray-500 mb-1 flex justify-between"},An={class:"col-span-2 text-right"},Cn={class:"px-6 py-4 bg-white flex justify-end gap-3 border-t border-gray-100"},En=["disabled"],In=Te({__name:"EditModal",props:{show:{type:Boolean},data:{},groupId:{}},emits:["update:show","save"],setup(n,{emit:e}){const s=n,l=e,i=We(),c=de(()=>((s.groupId?i.groups.find(t=>t.id===s.groupId)?.cardLayout:void 0)||i.appConfig.cardLayout)==="vertical"),d=de({get:()=>{const u=r.value.description1||"",t=r.value.description2||"",o=r.value.description3||"";return o?`${u}
${t}
${o}`:t?`${u}
${t}`:u},set:u=>{const t=u.split(`
`);r.value.description1=t[0]||"",r.value.description2=t[1]||"",r.value.description3=t[2]||""}}),f=u=>{const t=u.target;t.style.height="auto",t.style.height=t.scrollHeight+"px"},h=O("image"),g=O(!1),p=O(!1),x=ue([]),b=O("local"),C=ue([]),E=ue(null),w=ue(null),r=O({title:"",url:"",lanUrl:"",backupUrls:[],backupLanUrls:[],icon:"",description1:"",description2:"",description3:"",color:"bg-gray-100 text-gray-700",titleColor:"",isPublic:!1,backgroundImage:"",backgroundBlur:6,backgroundMask:.3,iconSize:100}),I=["ðŸ ","ðŸ”","ðŸ’»","ðŸ“±","ðŸ“¸","ðŸŽµ","ðŸŽ¬","ðŸ“š","ðŸ› ï¸","â˜ï¸","âš¡","ðŸ”¥","ðŸŒŸ","â¤ï¸","ðŸš€","ðŸŒ","ðŸŽ¨","ðŸ“‚","ðŸ“…","ðŸ›’","ðŸŽ","ðŸ±","ðŸ¶","ðŸ€","âš½"],F=()=>{const u=Math.floor(Math.random()*I.length);r.value.icon=I[u]||""},V=u=>new Promise(t=>{const o=new Image,v=setTimeout(()=>t(!1),3e3);o.onload=()=>{clearTimeout(v),t(o.width>1)},o.onerror=()=>{clearTimeout(v),t(!1)},o.src=u}),z=async()=>{if(!(C.value.length>0))try{const u=await fetch("/api/icons");if(u.ok){const t=await u.json();C.value=t.map(o=>`icons/${o}`)}}catch(u){console.error("Failed to fetch local icons",u)}},pe=async()=>{if(!E.value)try{const u=await fetch("https://api.iconify.design/collection?prefix=simple-icons");if(u.ok){const t=await u.json();t.uncategorized&&Array.isArray(t.uncategorized)&&(E.value=t.uncategorized.map(o=>({title:o,slug:o})))}}catch(u){console.error("Failed to fetch simple-icons data",u)}},J=["https://icon-manager.1851365c.er.aliyun-esa.net","https://icon-manager2.1851365c.er.aliyun-esa.net","http://icon-manager3.1851365c.er.aliyun-esa.net"],S=(u,t)=>u.map(o=>{const v=typeof o.url=="string"?o.url.trim():"",m=typeof o.downloadUrl=="string"?o.downloadUrl.trim():"";if(m){if(/^https?:\/\//i.test(m)||m.startsWith("//")||m.startsWith("data:"))return{...o,downloadUrl:m};try{return{...o,downloadUrl:new URL(m,t).href}}catch{return{...o,downloadUrl:""}}}if(/^https?:\/\//i.test(v)||v.startsWith("//")||v.startsWith("data:"))return{...o,downloadUrl:v};try{return{...o,downloadUrl:new URL(v||"",t).href}}catch{return{...o,downloadUrl:""}}}),j=u=>{const t=typeof u.downloadUrl=="string"?u.downloadUrl.trim():"";if(t){if(/^https?:\/\//i.test(t)||t.startsWith("//")||t.startsWith("data:"))return t;try{return new URL(t,J[0]).href}catch{return""}}const o=typeof u.url=="string"?u.url.trim():"";if(!o)return"";if(/^https?:\/\//i.test(o)||o.startsWith("//")||o.startsWith("data:"))return o;try{return new URL(o,J[0]).href}catch{return""}},P=async()=>{if(!w.value)try{const u=await fetch("/api/ali-icons");if(u.ok){const t=await u.json();w.value=Array.isArray(t)?t:null}else throw new Error("Proxy failed")}catch(u){console.warn("Proxy fetch failed, trying direct fetch...",u);try{const t=await Promise.allSettled(J.map(async m=>{const M=await fetch(`${m}/icons.json`);if(!M.ok)throw new Error(`Fetch failed: ${m}`);const Y=await M.json();if(!Array.isArray(Y))throw new Error(`Invalid icons.json: ${m}`);return S(Y,m)})),o=[],v=new Set;for(const m of t)if(m.status==="fulfilled")for(const M of m.value){const Y=M.downloadUrl||`${M.name}|${M.url}|${M.filename}`;v.has(Y)||(v.add(Y),o.push(M))}w.value=o.length>0?o:null}catch(t){console.error("Failed to fetch ali-icons data",t)}}},ee=u=>{try{let o=new URL(u).hostname.toLowerCase().replace(/^www\./,"");const v=[".com.cn",".net.cn",".org.cn",".gov.cn",".edu.cn",".co.uk",".co.jp",".co.kr",".com",".cn",".net",".org",".io",".me",".cc",".info",".biz",".tv",".top",".xyz",".edu",".gov",".mil",".int"];for(const m of v)if(o.endsWith(m)){o=o.slice(0,-m.length);break}if(o.includes(".")){const m=o.split(".");return m[m.length-1]||""}return o}catch{return""}},re=async()=>{let u="";const t=r.value.url||r.value.lanUrl;if(t&&(u=ee(t)),u||(u=r.value.title.trim()),!u)return alert("è¯·å…ˆå¡«å†™é“¾æŽ¥æˆ–æ ‡é¢˜ä½œä¸ºæœç´¢å…³é”®è¯ï¼");g.value=!0,h.value="image";try{console.log(`[Search] Starting Phase 1 (Local) for: "${u}"`),await z();const o=C.value.map(Q=>{const X=Q.split("/"),B=X[X.length-1],oe=B?B.split(".")[0]:"";return{path:Q,name:oe}}),M=new T(o,{keys:["name"],threshold:.3,ignoreLocation:!0}).search(u).map(Q=>Q.item.path);if(console.log(`[Search] Phase 1 found ${M.length} matches`),M.length>0){M.length===1?(console.log(`[Search] Auto-selecting single local match: ${M[0]}`),r.value.icon=M[0]||""):(console.log(`[Search] Showing selection modal for ${M.length} local matches`),x.value=M,b.value="local",p.value=!0);return}if(console.log(`[Search] Phase 1 failed. Starting Phase 2 (API) for: "${u}"`),await pe(),E.value){const B=new T(E.value,{keys:["title","slug"],threshold:.3,ignoreLocation:!0}).search(u).map(oe=>`https://cdn.simpleicons.org/${oe.item.slug}`);if(console.log(`[Search] Phase 2 found ${B.length} matches`),B.length>0){B.length===1?(console.log(`[Search] Auto-selecting single API match: ${B[0]}`),r.value.icon=B[0]||""):(console.log(`[Search] Showing selection modal for ${B.length} API matches`),x.value=B,b.value="api",p.value=!0);return}}if(console.log(`[Search] Phase 2 failed. Starting Phase 3 (AliYun) for: "${u}"`),await P(),w.value){const B=new T(w.value,{keys:["name","cnName","domain"],threshold:.3,ignoreLocation:!0}).search(u).map(oe=>j(oe.item)).filter(Boolean);if(console.log(`[Search] Phase 3 found ${B.length} matches`),B.length>0){B.length===1?(console.log(`[Search] Auto-selecting single Ali match: ${B[0]}`),r.value.icon=B[0]||""):(console.log(`[Search] Showing selection modal for ${B.length} Ali matches`),x.value=B,b.value="api",p.value=!0);return}}const Y=r.value.url||r.value.lanUrl;if(Y){const X=(new URL(Y).hostname.replace(/^www\./,"").split(".")[0]||"").toLowerCase();if(X){const B=`https://cdn.simpleicons.org/${X}`;if(await V(B)){r.value.icon=B;return}}}alert("æœªæ‰¾åˆ°é€‚é…çš„å›¾æ ‡ï¼Œå°è¯•ä½¿ç”¨è‡ªåŠ¨æŠ“å–åŠŸèƒ½ï¼Ÿ")}catch(o){console.error(o),alert("æœç´¢å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ")}finally{g.value=!1}},K=async()=>{let u=r.value.title.trim();if(!u){const t=r.value.url||r.value.lanUrl;t&&(u=ee(t))}if(!u){const t=r.value.icon?r.value.icon.trim():"";t&&!t.startsWith("http")&&!t.startsWith("/")&&!t.startsWith("data:")&&(u=t)}if(!u)return alert("è¯·è¾“å…¥æ ‡é¢˜æˆ–é“¾æŽ¥åŽé‡è¯•ï¼");await me(u)},me=async u=>{g.value=!0,h.value="image";try{if(console.log(`[Search] Searching AliYun for: "${u}"`),await P(),w.value){const v=new T(w.value,{keys:["name","cnName","domain"],threshold:.3,ignoreLocation:!0}).search(u).map(m=>j(m.item)).filter(Boolean);console.log(`[Search] Found ${v.length} matches`),v.length>0?v.length===1?r.value.icon=v[0]||"":(x.value=v,b.value="api",p.value=!0):alert("æœªæ‰¾åˆ°åŒ¹é…çš„ç½‘ç»œå›¾æ ‡")}else alert("èŽ·å–å›¾æ ‡åº“å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ")}catch(t){console.error(t),alert("æœç´¢å¤±è´¥")}finally{g.value=!1}},U=()=>{const u=r.value.url||r.value.lanUrl;if(!u)return alert("è¯·å…ˆå¡«å†™é“¾æŽ¥ï¼");const t=ee(u);if(!t)return alert("æ— æ³•ä»Žé“¾æŽ¥æå–æœ‰æ•ˆå…³é”®è¯");me(t)},te=u=>{r.value.icon=u},le=async u=>{try{const t=await fetch(`/api/get-icon-base64?url=${encodeURIComponent(u)}`);if(t.ok){const o=await t.json();if(o.success&&o.icon)return o.icon}}catch(t){console.warn("Failed to fetch base64 icon",t)}return null},et=async()=>{const u=r.value.url||r.value.lanUrl;if(!u)return alert("è¯·å…ˆå¡«å†™é“¾æŽ¥ï¼");g.value=!0,h.value="image";try{const t=new URL(u),o=[`https://www.favicon.vip/get.php?url=${encodeURIComponent(u)}`,`https://icon.bqb.cool?url=${encodeURIComponent(u)}`,`https://api.afmax.cn/so/ico/index.php?r=${encodeURIComponent(u)}`,`https://api.quickso.cn/api/favicon/index.php?url=${encodeURIComponent(u)}`,`${t.origin}/favicon.ico`];let v=!1;for(const m of o){const M=await le(m);if(M){r.value.icon=M,v=!0;break}if(await V(m)){r.value.icon=m,v=!0;break}}v||(F(),h.value="emoji")}catch{alert("é“¾æŽ¥æ ¼å¼é”™è¯¯ï¼Œæ— æ³•æŠ“å–"),g.value=!1}finally{g.value=!1}};Ce(()=>s.show,u=>{if(u)if(s.data){r.value={...s.data,backupUrls:s.data.backupUrls?s.data.backupUrls.map(v=>typeof v=="string"?{name:"",url:v}:{...v}):[],backupLanUrls:s.data.backupLanUrls?s.data.backupLanUrls.map(v=>typeof v=="string"?{name:"",url:v}:{...v}):[],description1:s.data.description1||"",description2:s.data.description2||"",description3:s.data.description3||"",titleColor:s.data.titleColor||"",backgroundImage:s.data.backgroundImage||"",backgroundBlur:s.data.backgroundBlur??6,backgroundMask:s.data.backgroundMask??.3,iconSize:s.data.iconSize??100};const t=r.value.icon||"",o=t.length>0&&(t.length>4||t.includes("/")||t.includes(".")||t.includes(":")||t.startsWith("data:"));h.value=o?"image":"emoji",t||(h.value="image")}else r.value={title:"",url:"",lanUrl:"",backupUrls:[],backupLanUrls:[],icon:"",color:"bg-gray-100 text-gray-700",titleColor:"",isPublic:!1,backgroundImage:"",backgroundBlur:6,backgroundMask:.3,iconSize:100},h.value="image"},{immediate:!0});const tt=()=>{r.value.backupUrls||(r.value.backupUrls=[]),r.value.backupUrls.push({name:"",url:""})},st=u=>{r.value.backupUrls&&r.value.backupUrls.splice(u,1)},nt=()=>{r.value.backupLanUrls||(r.value.backupLanUrls=[]),r.value.backupLanUrls.push({name:"",url:""})},rt=u=>{r.value.backupLanUrls&&r.value.backupLanUrls.splice(u,1)},Se=u=>u?/^(https?|ftp):\/\/[^\s/$.?#].[^\s]*$/i.test(u):!0,Ue=u=>{const t=u.target,o=t.parentElement?.parentElement;if(o){const v=o.querySelectorAll("input");v.length>1&&v[0]===t&&v[1]&&(v[1].focus(),u.preventDefault())}},ve=()=>l("update:show",!1),ye=O(!1),xe=O(!1),De=()=>{const u=r.value.icon;if(u&&u.startsWith("http")&&!u.includes("favicon.ico")&&!u.includes("api.uomg.com")&&!u.includes("simpleicons.org")&&!u.includes("api.afmax.cn")&&!u.includes("api.quickso.cn")&&!u.includes("favicon.vip")&&!u.includes("icon.bqb.cool")){console.log("Icon load failed, trying to fallback to reliable API:",u);try{const t=new URL(u);r.value.icon=`https://api.afmax.cn/so/ico/index.php?r=https://${t.hostname}`;return}catch{}}r.value.icon=""},ot=()=>{xe.value=!0,!ye.value&&De()},at=()=>{ye.value=!1,xe.value&&De()},lt=()=>{xe.value=!1},be=O(!0),ie=O(!1),it=async u=>{const t=u.trim();if(!t)return null;if(t.startsWith("/icon-cache/"))return t;const o=t.startsWith("data:")?{dataUrl:t}:/^https?:\/\//i.test(t)?{url:t}:null;if(!o)return null;try{const v=await fetch("/api/icon-cache",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(!v.ok)return null;const m=await v.json();if(m&&m.success&&typeof m.path=="string"&&m.path)return m.path}catch{}return null},ut=async()=>{if(!r.value.title&&!r.value.url)return alert("æ ‡é¢˜å’Œé“¾æŽ¥æ€»å¾—å†™ä¸€ä¸ªå§ï¼");ie.value=!0;try{if(h.value==="image"&&be.value){const u=(r.value.icon||"").trim();if(u&&!u.startsWith("/icon-cache/")){const t=await it(u);t&&(r.value.icon=t)}}l("save",{item:{...r.value,id:s.data?.id},groupId:s.groupId}),ve()}finally{ie.value=!1}};return(u,t)=>n.show?(A(),k("div",ws,[a("div",ks,[a("div",As,[a("h3",Cs,D(n.data?"ä¿®æ”¹é¡¹ç›®":"æ·»åŠ æ–°é¡¹ç›®"),1),a("div",Es,[t[30]||(t[30]=a("span",{class:"text-xs font-bold text-gray-500"},"å…¬å¼€",-1)),a("label",Is,[$(a("input",{type:"checkbox","onUpdate:modelValue":t[0]||(t[0]=o=>r.value.isPublic=o),class:"sr-only peer"},null,512),[[Re,r.value.isPublic]]),t[29]||(t[29]=a("div",{class:"w-9 h-5 bg-gray-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-gray-900"},null,-1))])]),a("button",{onClick:ve,class:"text-gray-400 hover:text-gray-600 text-2xl leading-none"}," Ã— ")]),a("div",Ms,[a("div",Bs,[a("div",$s,[t[31]||(t[31]=a("label",{class:"block text-sm font-medium text-gray-600 mb-1"},[Z("æ ‡é¢˜ "),a("span",{class:"text-red-500"},"*")],-1)),a("div",_s,[$(a("input",{"onUpdate:modelValue":t[1]||(t[1]=o=>r.value.title=o),type:"text",class:"w-full px-4 py-2 rounded-lg border border-gray-200 focus:border-gray-900 outline-none transition-colors pr-24",placeholder:"ä¾‹å¦‚ï¼šæˆ‘çš„åšå®¢"},null,512),[[L,r.value.title]]),a("button",{onClick:K,class:"absolute right-1 top-1 bottom-1 px-3 bg-gray-50 text-gray-600 text-xs font-medium rounded-md hover:bg-gray-100 flex items-center gap-1 transition-colors",title:"æ ¹æ®æ ‡é¢˜æœç´¢ç½‘ç»œå›¾æ ‡åº“"}," åŒ¹é…å›¾æ ‡ ")])]),a("div",null,[t[32]||(t[32]=a("label",{class:"block text-sm font-medium text-gray-600 mb-1"},"æ ‡é¢˜é¢œè‰²",-1)),a("div",Fs,[$(a("input",{"onUpdate:modelValue":t[2]||(t[2]=o=>r.value.titleColor=o),type:"color",class:"w-8 h-8 rounded cursor-pointer border-none p-0 bg-transparent",title:"é€‰æ‹©æ ‡é¢˜é¢œè‰²"},null,512),[[L,r.value.titleColor]]),r.value.titleColor?(A(),k("button",{key:0,onClick:t[3]||(t[3]=o=>r.value.titleColor=""),class:"ml-2 text-xs text-gray-400 hover:text-red-500",title:"æ¸…é™¤é¢œè‰²"}," âœ• ")):_("",!0)])])]),c.value?_("",!0):(A(),k("div",Ls,[t[33]||(t[33]=a("label",{class:"block text-xs font-medium text-gray-500 mb-1"},"æè¿° (æ°´å¹³æ¨¡å¼æ˜¾ç¤ºï¼Œæ¯è¡Œå¯¹åº”ä¸€è¡Œæ–‡å­—)",-1)),$(a("textarea",{"onUpdate:modelValue":t[4]||(t[4]=o=>d.value=o),onInput:f,class:"w-full px-3 py-2 rounded-lg border border-gray-200 focus:border-gray-900 outline-none transition-colors text-sm resize-none overflow-hidden",placeholder:`ç¬¬ä¸€è¡Œ (ä¸Š)
ç¬¬äºŒè¡Œ (ä¸­)
ç¬¬ä¸‰è¡Œ (ä¸‹)`,rows:"3"},null,544),[[L,d.value]])])),a("div",null,[a("label",{class:"block text-sm font-medium text-gray-600 mb-1"},[t[34]||(t[34]=Z("å¤–ç½‘é“¾æŽ¥ ",-1)),t[35]||(t[35]=a("span",{class:"text-red-500"},"*",-1)),a("button",{onClick:tt,class:"ml-2 text-xs text-gray-500 hover:text-gray-900 hover:underline",title:"æ·»åŠ å¤‡ç”¨å¤–ç½‘åœ°å€"}," + å¤‡ç”¨åœ°å€ ")]),a("div",Ss,[$(a("input",{"onUpdate:modelValue":t[5]||(t[5]=o=>r.value.url=o),type:"text",class:"w-full px-4 py-2 rounded-lg border border-gray-200 focus:border-gray-900 outline-none transition-colors pr-24",placeholder:"https://example.com"},null,512),[[L,r.value.url]]),a("button",{onClick:U,class:"absolute right-1 top-1 bottom-1 px-3 bg-gray-50 text-gray-600 text-xs font-medium rounded-md hover:bg-gray-100 flex items-center gap-1 transition-colors",title:"æ ¹æ®é“¾æŽ¥äºŒçº§åŸŸååŒ¹é…å›¾æ ‡"}," åŒ¹é…å›¾æ ‡ ")]),r.value.backupUrls&&r.value.backupUrls.length>0?(A(),k("div",Us,[(A(!0),k(ne,null,he(r.value.backupUrls,(o,v)=>(A(),k("div",{key:"backup-wan-"+v,class:"flex flex-col sm:flex-row gap-2 items-start sm:items-center p-2 bg-gray-50 rounded-lg border border-gray-100"},[a("div",Ds,[$(a("input",{"onUpdate:modelValue":m=>o.name=m,type:"text",maxlength:"50",class:G(["w-full px-3 py-2 rounded-lg border focus:border-gray-900 outline-none transition-colors text-sm pr-8",[r.value.backupUrls.filter((m,M)=>m.name&&m.name===o.name&&M!==v).length>0?"border-red-300":"border-gray-200"]]),placeholder:"åç§°",onKeydown:[t[6]||(t[6]=se(ae(()=>{},["prevent"]),["enter"])),t[7]||(t[7]=se(m=>Ue(m),["tab"]))]},null,42,Rs),[[L,o.name]]),o.name?(A(),k("button",{key:0,onClick:m=>o.name="",class:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-red-500 rounded-full p-0.5",title:"æ¸…é™¤"},[...t[36]||(t[36]=[a("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",class:"w-3 h-3"},[a("path",{d:"M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"})],-1)])],8,js)):_("",!0)]),a("div",Ps,[$(a("input",{"onUpdate:modelValue":m=>o.url=m,type:"text",maxlength:"500",class:G(["w-full px-3 py-2 rounded-lg border focus:border-gray-900 outline-none transition-colors text-sm pr-8",Se(o.url)?"border-gray-200":"border-red-300 bg-red-50"]),placeholder:"è¯·è¾“å…¥å®Œæ•´URLåœ°å€",onKeydown:t[8]||(t[8]=se(ae(()=>{},["prevent"]),["enter"]))},null,42,Os),[[L,o.url]]),o.url?(A(),k("button",{key:0,onClick:m=>o.url="",class:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-red-500 rounded-full p-0.5",title:"æ¸…é™¤"},[...t[37]||(t[37]=[a("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",class:"w-3 h-3"},[a("path",{d:"M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"})],-1)])],8,Ns)):_("",!0)]),a("button",{onClick:m=>st(v),class:"text-gray-400 hover:text-red-500 p-2 sm:p-1 self-end sm:self-center",title:"åˆ é™¤"}," âœ• ",8,Vs)]))),128))])):_("",!0)]),a("div",null,[a("label",{class:"block text-sm font-medium text-gray-600 mb-1"},[t[38]||(t[38]=Z("å†…ç½‘é“¾æŽ¥ ",-1)),t[39]||(t[39]=a("span",{class:"text-gray-400 text-xs"},"(é€‰å¡«ï¼Œå†…ç½‘è®¿é—®æ—¶ä¼˜å…ˆè·³è½¬)",-1)),a("button",{onClick:nt,class:"ml-2 text-xs text-gray-500 hover:text-gray-900 hover:underline",title:"æ·»åŠ å¤‡ç”¨å†…ç½‘åœ°å€"}," + å¤‡ç”¨åœ°å€ ")]),$(a("input",{"onUpdate:modelValue":t[9]||(t[9]=o=>r.value.lanUrl=o),type:"text",placeholder:"http://192.168.1.x:8080",class:"w-full px-4 py-2 rounded-lg border border-gray-200 focus:border-gray-900 outline-none transition-colors"},null,512),[[L,r.value.lanUrl]]),r.value.backupLanUrls&&r.value.backupLanUrls.length>0?(A(),k("div",zs,[(A(!0),k(ne,null,he(r.value.backupLanUrls,(o,v)=>(A(),k("div",{key:"backup-lan-"+v,class:"flex flex-col sm:flex-row gap-2 items-start sm:items-center p-2 bg-gray-50 rounded-lg border border-gray-100"},[a("div",Ts,[$(a("input",{"onUpdate:modelValue":m=>o.name=m,type:"text",maxlength:"50",class:G(["w-full px-3 py-2 rounded-lg border focus:border-gray-900 outline-none transition-colors text-sm pr-8",[r.value.backupLanUrls.filter((m,M)=>m.name&&m.name===o.name&&M!==v).length>0?"border-red-300":"border-gray-200"]]),placeholder:"åç§°",onKeydown:[t[10]||(t[10]=se(ae(()=>{},["prevent"]),["enter"])),t[11]||(t[11]=se(m=>Ue(m),["tab"]))]},null,42,Ws),[[L,o.name]]),o.name?(A(),k("button",{key:0,onClick:m=>o.name="",class:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-red-500 rounded-full p-0.5",title:"æ¸…é™¤"},[...t[40]||(t[40]=[a("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",class:"w-3 h-3"},[a("path",{d:"M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"})],-1)])],8,Ks)):_("",!0)]),a("div",Ys,[$(a("input",{"onUpdate:modelValue":m=>o.url=m,type:"text",maxlength:"500",class:G(["w-full px-3 py-2 rounded-lg border focus:border-gray-900 outline-none transition-colors text-sm pr-8",Se(o.url)?"border-gray-200":"border-red-300 bg-red-50"]),placeholder:"è¯·è¾“å…¥å®Œæ•´URLåœ°å€",onKeydown:t[12]||(t[12]=se(ae(()=>{},["prevent"]),["enter"]))},null,42,Gs),[[L,o.url]]),o.url?(A(),k("button",{key:0,onClick:m=>o.url="",class:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-red-500 rounded-full p-0.5",title:"æ¸…é™¤"},[...t[41]||(t[41]=[a("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",class:"w-3 h-3"},[a("path",{d:"M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"})],-1)])],8,Hs)):_("",!0)]),a("button",{onClick:m=>rt(v),class:"text-gray-400 hover:text-red-500 p-2 sm:p-1 self-end sm:self-center",title:"åˆ é™¤"}," âœ• ",8,Js)]))),128))])):_("",!0)]),a("div",null,[a("div",Qs,[a("div",Xs,[a("div",Zs,[t[42]||(t[42]=a("label",{class:"text-sm font-medium text-gray-600"},"å›¾æ ‡æ ·å¼",-1)),a("div",qs,[a("button",{onClick:t[13]||(t[13]=o=>h.value="image"),class:G(["px-3 py-1 rounded-md transition-all",h.value==="image"?"bg-white text-gray-800 shadow-sm font-medium":"text-gray-500 hover:text-gray-700"])}," å›¾ç‰‡ ",2),a("button",{onClick:t[14]||(t[14]=o=>h.value="emoji"),class:G(["px-3 py-1 rounded-md transition-all",h.value==="emoji"?"bg-white text-gray-800 shadow-sm font-medium":"text-gray-500 hover:text-gray-700"])}," Emoji ",2)])]),h.value==="image"?(A(),k("label",en,[$(a("input",{"onUpdate:modelValue":t[15]||(t[15]=o=>be.value=o),type:"checkbox",class:"w-4 h-4 rounded border-gray-300 text-gray-900 focus:ring-gray-500"},null,512),[[Re,be.value]]),t[43]||(t[43]=a("span",null,"ä¿å­˜åˆ°æœ¬åœ°ç¼“å­˜ï¼ˆæŽ¨èï¼Œé…ç½®æ›´å°ï¼‰",-1))])):_("",!0),a("div",tn,[a("button",{onClick:re,disabled:g.value,class:G(["text-xs flex items-center gap-1 px-3 py-1.5 rounded-lg font-medium transition-all",g.value?"bg-gray-100 text-gray-400":"bg-gray-100 text-gray-600 hover:bg-gray-200"])},[g.value?(A(),k("span",nn)):_("",!0),Z(" "+D(g.value?"é€‚é…ä¸­...":"æœ¬åœ°åŒ¹é…"),1)],10,sn),a("button",{onClick:et,disabled:g.value,class:G(["text-xs flex items-center gap-1 px-3 py-1.5 rounded-lg font-medium transition-all",g.value?"bg-gray-100 text-gray-400":"bg-gray-100 text-gray-600 hover:bg-gray-200"])},[g.value?(A(),k("span",on)):_("",!0),Z(" "+D(g.value?"æ­£åœ¨èŽ·å–...":"è‡ªåŠ¨æŠ“å–"),1)],10,rn)])]),a("div",an,[h.value==="image"?(A(),k(ne,{key:0},[r.value.icon?(A(),k("img",{key:0,src:Ee(i).getAssetUrl(r.value.icon),class:"w-full h-full object-cover transition-transform duration-200",style:dt({transform:`scale(${(r.value.iconSize??100)/100})`}),onError:ot,onLoad:lt},null,44,ln)):(A(),k("span",un,"é¢„è§ˆ"))],64)):(A(),k(ne,{key:1},[r.value.icon?(A(),k("span",cn,D(r.value.icon),1)):(A(),k("span",dn,"Emoji"))],64))])]),h.value==="emoji"?(A(),k("div",hn,[$(a("input",{"onUpdate:modelValue":t[16]||(t[16]=o=>r.value.icon=o),type:"text",class:"w-full px-4 py-2 rounded-lg border border-gray-200 focus:border-gray-900 outline-none pr-20 text-xl",placeholder:"è¾“å…¥ Emoji"},null,512),[[L,r.value.icon]]),a("button",{onClick:F,class:"absolute right-1 top-1 bottom-1 px-3 bg-gray-50 text-gray-600 text-xs font-medium rounded-md hover:bg-gray-100 flex items-center gap-1 transition-colors"}," éšæœº ")])):(A(),k("div",gn,[a("div",fn,[$(a("input",{"onUpdate:modelValue":t[17]||(t[17]=o=>r.value.icon=o),type:"text",placeholder:"å›¾ç‰‡ URL åœ°å€...",class:"w-full px-4 py-2 rounded-lg border border-gray-200 text-sm focus:border-gray-900 outline-none",onFocus:t[18]||(t[18]=o=>ye.value=!0),onBlur:at},null,544),[[L,r.value.icon]])]),t[45]||(t[45]=a("div",{class:"text-xs text-gray-400 text-center flex items-center gap-2 before:h-px before:bg-gray-200 before:flex-1 after:h-px after:bg-gray-200 after:flex-1"}," æˆ– ",-1)),a("div",pn,[t[44]||(t[44]=a("span",{class:"text-xs text-gray-400 whitespace-nowrap"},"ç¼©æ”¾",-1)),$(a("input",{type:"range","onUpdate:modelValue":t[19]||(t[19]=o=>r.value.iconSize=o),min:"20",max:"200",step:"5",class:"w-full h-1.5 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-400"},null,512),[[L,r.value.iconSize,void 0,{number:!0}]]),a("span",mn,D(r.value.iconSize)+"%",1)]),we(je,{modelValue:r.value.icon,"onUpdate:modelValue":t[20]||(t[20]=o=>r.value.icon=o)},null,8,["modelValue"])]))]),a("div",vn,[t[48]||(t[48]=a("label",{class:"block text-sm font-medium text-gray-600 mb-2"},[Z("å¡ç‰‡èƒŒæ™¯ "),a("span",{class:"text-xs text-gray-400 font-normal"},"(å¯é€‰ï¼Œæ”¯æŒæ¨¡ç³Šå’Œé®ç½©æ•ˆæžœ)")],-1)),a("div",yn,[a("div",xn,[$(a("input",{"onUpdate:modelValue":t[21]||(t[21]=o=>r.value.backgroundImage=o),type:"text",placeholder:"èƒŒæ™¯å›¾ URL...",class:"flex-1 px-4 py-2 rounded-lg border border-gray-200 text-sm focus:border-gray-900 outline-none"},null,512),[[L,r.value.backgroundImage]]),r.value.backgroundImage?(A(),k("button",{key:0,onClick:t[22]||(t[22]=o=>r.value.backgroundImage=""),class:"text-gray-400 hover:text-red-500 px-2",title:"æ¸…é™¤èƒŒæ™¯"}," âœ• ")):_("",!0)]),we(je,{modelValue:r.value.backgroundImage,"onUpdate:modelValue":t[23]||(t[23]=o=>r.value.backgroundImage=o),crop:!1,uploadOnly:!0,previewStyle:{filter:`blur(${r.value.backgroundBlur??6}px)`,transform:"scale(1.1)"},overlayStyle:{backgroundColor:`rgba(0,0,0,${r.value.backgroundMask??.3})`}},null,8,["modelValue","previewStyle","overlayStyle"]),r.value.backgroundImage?(A(),k("div",bn,[a("div",null,[a("label",wn,[t[46]||(t[46]=a("span",null,"æ¨¡ç³ŠåŠå¾„",-1)),a("span",null,D(r.value.backgroundBlur)+"px",1)]),$(a("input",{type:"range","onUpdate:modelValue":t[24]||(t[24]=o=>r.value.backgroundBlur=o),min:"0",max:"20",step:"1",class:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-400"},null,512),[[L,r.value.backgroundBlur,void 0,{number:!0}]])]),a("div",null,[a("label",kn,[t[47]||(t[47]=a("span",null,"é®ç½©æµ“åº¦",-1)),a("span",null,D(Math.round((r.value.backgroundMask||0)*100))+"%",1)]),$(a("input",{type:"range","onUpdate:modelValue":t[25]||(t[25]=o=>r.value.backgroundMask=o),min:"0",max:"1",step:"0.1",class:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-400"},null,512),[[L,r.value.backgroundMask,void 0,{number:!0}]])]),a("div",An,[a("button",{onClick:t[26]||(t[26]=o=>{r.value.backgroundImage="",r.value.backgroundBlur=6,r.value.backgroundMask=.3}),class:"text-xs text-red-500 hover:text-red-700 underline"}," ç§»é™¤èƒŒæ™¯ ")])])):_("",!0)])])]),a("div",Cn,[a("button",{onClick:ve,class:"px-4 py-2 rounded-lg text-gray-600 hover:bg-gray-100 transition-colors text-sm font-medium"}," å–æ¶ˆ "),a("button",{onClick:ut,disabled:ie.value,class:"px-6 py-2 rounded-lg bg-gray-900 text-white hover:bg-black transition-all active:scale-95 text-sm font-medium"},D(ie.value?"ä¿å­˜ä¸­...":n.data?"ä¿å­˜ä¿®æ”¹":"ç¡®è®¤æ·»åŠ "),9,En)])]),we(Dt,{show:p.value,"onUpdate:show":t[27]||(t[27]=o=>p.value=o),candidates:x.value,title:r.value.title,source:b.value,onSelect:te,onCancelLink:t[28]||(t[28]=o=>p.value=!1)},null,8,["show","candidates","title","source"])])):_("",!0)}}),$n=ht(In,[["__scopeId","data-v-c83d4d66"]]);export{$n as default};
